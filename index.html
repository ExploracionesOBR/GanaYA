<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ´ GANA YA! - LoterÃ­a Interactiva Mexicana (v9.4)</title>
<style>
:root{
  --rojo:#b42222;--verde:#0f8a3c;--azul:#1565d8;
  --naranja:#f77f00;--crema:#fff8ec;
  --sombra:0 10px 28px rgba(0,0,0,0.12);
  --accent1:#ffd60a;--accent2:#ff6bcb;
}
body{
  font-family:'Segoe UI',Tahoma,sans-serif;
  background:var(--crema);
  margin:0;padding:0;
  overflow-x:hidden;
}
.container{
  max-width:1200px;margin:auto;padding:10px;
  text-align:center;
}
h1{text-align:center;color:var(--rojo);}

/* ======== CARTAS ========= */
.cards-grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:14px;
  justify-content:center;
  align-items:start;
  margin:0 auto;
  max-width:900px;
  padding-top:10px;
}
.card{
  width:120px;height:180px;
  perspective:1200px;
  margin:auto;
  position:relative;
}
.card-inner{
  width:100%;height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:transform .6s cubic-bezier(.2,.9,.3,1);
}
.card-front,.card-back{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 6px 14px rgba(0,0,0,.18);
}
.card-front{
  background-size:cover;
  background-position:center;
}
.card-back{
  transform:rotateY(180deg);
  background:repeating-linear-gradient(45deg,#f6f6f6 0 10px,#e9e9e9 10px 20px);
}
.card-back::after{
  content:"";
  position:absolute;left:50%;top:50%;
  width:64px;height:64px;
  transform:translate(-50%,-50%);
  background-image:url('logo_color.png');
  background-size:contain;
  background-repeat:no-repeat;
  opacity:0.95;
  pointer-events:none;
}
.card.flipped .card-inner{transform:rotateY(180deg);}
.logo-overlay{
  position:absolute;bottom:8px;right:8px;
  width:44px;height:44px;
  background-image:url('logo_color.png');
  background-size:contain;
  background-repeat:no-repeat;
  filter:none!important;
  opacity:.9;
}

/* ======== ANIMACIÃ“N DE BARAJEO ======== */
@keyframes shuffleCards{
  0%{transform:translateY(0) rotate(0deg) scale(1);}
  25%{transform:translateY(-26px) rotate(-6deg) scale(1.03);}
  50%{transform:translateY(18px) rotate(8deg) scale(.98);}
  75%{transform:translateY(-12px) rotate(-3deg) scale(1.02);}
  100%{transform:translateY(0) rotate(0) scale(1);}
}
.card.shuffle{animation:shuffleCards .75s cubic-bezier(.2,.9,.3,1);}
.card::before{
  content:"";
  position:absolute;top:0;left:-80%;
  width:55%;height:100%;
  background:linear-gradient(120deg,rgba(255,255,255,.45) 0%,rgba(255,255,255,0) 100%);
  transform:skewX(-18deg);
}
.card.shine::before{animation:shineMove 1.1s forwards;}
@keyframes shineMove{100%{left:140%;}}

/* ======== MODALES ======== */
.modal-back{backdrop-filter:blur(3px);transition:opacity .28s ease;}
.modal{opacity:0;transform:scale(.96);transition:opacity .28s ease,transform .28s ease;}
.modal.show{opacity:1;transform:scale(1);}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ´ GANA YA!</h1>
  <div id="budget-area">
    <input id="input-budget" type="number" placeholder="Ingresa tu presupuesto ğŸ’°">
    <p id="budget-hint"></p>
    <button id="btn-save-purchase">Guardar compra</button>
    <button id="btn-shuffle">ğŸ² Barajear</button>
  </div>
  <div id="cards-container" class="cards-grid"></div>
</div>

<script>
const purchases=[],winners=[];

/* ===== AUTOAJUSTE DE PRESUPUESTO ===== */
document.getElementById('input-budget').addEventListener('input',()=>{
  const val=parseFloat(document.getElementById('input-budget').value||0);
  const out=document.getElementById('budget-hint');
  if(val<=0){out.textContent='Ingresa un monto vÃ¡lido ğŸ’°';return;}
  const combos=[];
  if(val%40===0)combos.push(`${val/40} de 4 cartas`);
  if(val%60===0)combos.push(`${val/60} de 6 cartas`);
  if(val%80===0)combos.push(`${val/80} de 8 cartas`);
  if(combos.length>0){
    out.innerHTML=`ğŸ’¡ Con $${val} puedes comprar: ${combos.join(', ')}.`;
    document.getElementById('btn-save-purchase').disabled=false;
  }else{
    out.innerHTML='âš ï¸ El monto ingresado no coincide con ninguna combinaciÃ³n exacta.';
    document.getElementById('btn-save-purchase').disabled=true;
  }
});

/* ===== GENERAR CARTAS DE PRUEBA ===== */
function cardImageUrl(id){return `Cartas_baraja_loteria/${id}.png`;}
function generateCards(num=10){
  const container=document.getElementById('cards-container');
  let html='';
  for(let i=1;i<=num;i++){
    html+=`
    <div class="card" id="card-${i}">
      <div class="card-inner">
        <div class="card-front" style="background-image:url('${cardImageUrl(i)}')">
          <div class="logo-overlay"></div>
        </div>
        <div class="card-back"></div>
      </div>
    </div>`;
  }
  container.innerHTML=html;
}
generateCards(10);

/* ===== BARAJEO ANIMADO ===== */
function sequenceClass(elements,className,delay,duration){
  elements.forEach((el,i)=>{
    setTimeout(()=>el.classList.add(className),i*delay);
    setTimeout(()=>el.classList.remove(className),i*delay+duration);
  });
}
function shuffleDeckVisual(){
  const cards=[...document.querySelectorAll('.card')];
  if(!cards.length)return;
  cards.forEach(c=>c.classList.remove('flipped'));
  sequenceClass(cards,'shuffle',85,900);
  sequenceClass(cards,'shine',95,1200);
}
document.getElementById('btn-shuffle').addEventListener('click',()=>{
  shuffleDeckVisual();
});

/* ===== MENSAJE WHATSAPP MEJORADO ===== */
function confirmWhatsapp(id){
  const p=purchases.find(x=>x.id===id);
  if(!p)return alert('No encontrado');
  if(!p.cell)return alert('No hay nÃºmero registrado');
  if(!p.clabe)return alert('No hay CLABE registrada');
  const amount='$'+(p.totalPaid||'0');
  const date=new Date().toLocaleString();
  const carta='La Estrella â­';
  const msg=`ğŸ‰ *Â¡FELICIDADES ${p.playerName?.toUpperCase()||'JUGADOR'}!* ğŸ‰\\n\\nTu premio ha sido *confirmado y pagado correctamente*. ğŸ†\\n\\nğŸ’µ *Monto del premio:* ${amount}\\nğŸ“† *Fecha de pago:* ${date}\\n\\nğŸ€ *Tu carta de la suerte fue:* ${carta}\\n\\nGracias por jugar con *GANA YA!* ğŸ´\\nÂ¡Te esperamos en la prÃ³xima partida con mÃ¡s suerte y diversiÃ³n! ğŸŠ`;
  const url=`https://wa.me/${p.cell}?text=${encodeURIComponent(msg)}`;
  window.open(url,'_blank');
}
</script>
</body>
</html>

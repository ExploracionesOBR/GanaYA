<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GANA YA! üéâ</title>
<style>
/* --- Dise√±o mexicano festivo --- */
body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    background-color: #fff5e1;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}
header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 20px;
    background: linear-gradient(90deg,#ffcc00,#ff6600);
    color: #fff;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}
header h1 {
    font-size: 2em;
    margin: 0;
}
header img {
    height: 60px;
}
#bolsa {
    font-size: 1.5em;
    font-weight: bold;
    margin: 10px;
}
button {
    cursor: pointer;
    padding: 8px 12px;
    margin: 4px;
    border: none;
    border-radius: 8px;
    font-size: 1em;
    font-weight: bold;
    transition: 0.3s;
}
button:hover {
    box-shadow: 0 0 8px gold;
}
.active {
    box-shadow: 0 0 12px gold;
}

/* --- √Årea de cartas de jugadores --- */
#cartas-jugadores {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    grid-auto-rows: 160px;
    gap: 10px;
    padding: 20px;
    max-width: 1200px;
    margin: auto;
}
.carta {
    position: relative;
    background-color: #fff;
    border-radius: 8px;
    border: 2px solid #ff6600;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.2em;
    color: #333;
    transition: transform 0.3s, box-shadow 0.3s;
}
.carta.ganadora {
    grid-column: span 2;
    grid-row: span 2;
    font-size: 1.8em;
    box-shadow: 0 0 20px gold;
    transform: scale(1.2);
}

/* --- Modales --- */
.modal {
    display: none;
    position: fixed;
    z-index: 999;
    left: 0; top: 0;
    width: 100%; height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.6);
}
.modal-content {
    background-color: #fff;
    margin: 10% auto;
    padding: 20px;
    border-radius: 12px;
    width: 80%;
    max-width: 600px;
    position: relative;
}
.modal-close {
    position: absolute;
    top: 10px;
    right: 14px;
    font-size: 1.5em;
    cursor: pointer;
}

/* --- Animaciones confeti --- */
.confeti-piece {
    position: absolute;
    width: 10px;
    height: 10px;
    background-color: red;
    opacity: 0.8;
    animation: confetiFall 3s linear infinite;
}
@keyframes confetiFall {
    0% { transform: translateY(-10px) rotate(0deg);}
    100% { transform: translateY(500px) rotate(360deg);}
}
</style>
</head>
<body>

<header>
    <h1>üéâ GANA YA!</h1>
    <img src="logo_1_entrada.png" alt="Logo">
</header>

<div id="bolsa">üí∞ Bolsa: $0.00</div>

<!-- √Årea de control -->
<div style="text-align:center; margin:10px;">
    <button id="modo4" class="active">4 CARTAS</button>
    <button id="modo6">6 CARTAS</button>
</div>

<!-- Cartas de jugadores -->
<div id="cartas-jugadores"></div>

<!-- Modales -->
<div id="modal-detalle" class="modal">
    <div class="modal-content">
        <span class="modal-close">&times;</span>
        <div id="detalle-jugador"></div>
        <button id="tomar-captura">üì∏ TOMAR CAPTURA</button>
    </div>
</div>

<!-- Script principal -->
<script>
// --- Variables ---
let modo = 4; // 4 o 6 cartas
let ultimaID = 234; // empieza desde GanaYA!-0234
let jugadores = []; // array de jugadores

// --- Funciones auxiliares ---
function generarID() {
    let id = "GanaYA!-"+(ultimaID++).toString().padStart(4,'0');
    return id;
}

function crearJugador(nombre, numPartidas) {
    let nuevasPartidas = [];
    for(let i=0;i<numPartidas;i++){
        let id = generarID();
        let cartas = generarCartas(modo);
        nuevasPartidas.push({id:id, cartas:cartas, estado:"POR PAGAR"});
    }
    jugadores.push({nombre:nombre, partidas:nuevasPartidas});
    abrirWhatsAppRegistro(nombre, nuevasPartidas);
    renderCartas();
}

// Genera cartas aleatorias
const todasCartas = ["El Gallo","La Dama","El Valiente","La Rosa","El Nopal","La Luna","El Cotorro","El Venado","El Apache","La Bandera","El Pino","La Chalupa","El Mundo","El Barril","El Pescado","El Tambor","La Calavera","El Camar√≥n","La Muerte","La Pera","La Mano","La Sirena","El Arpa"];
function generarCartas(cantidad){
    let seleccionadas = [];
    while(seleccionadas.length < cantidad){
        let carta = todasCartas[Math.floor(Math.random()*todasCartas.length)];
        if(!seleccionadas.includes(carta)) seleccionadas.push(carta);
    }
    return seleccionadas;
}

// Render cartas
function renderCartas(){
    let cont = document.getElementById('cartas-jugadores');
    cont.innerHTML = "";
    jugadores.forEach(j=>{
        j.partidas.forEach(p=>{
            let div = document.createElement('div');
            div.className = "carta";
            div.textContent = p.id;
            if(p.estado === "GANADOR") div.classList.add("ganadora");
            div.onclick = ()=>abrirModalDetalle(j,p);
            cont.appendChild(div);
        });
    });
}

// Modal detalle jugador
let modal = document.getElementById('modal-detalle');
let span = document.querySelector('.modal-close');
span.onclick = ()=>modal.style.display = "none";
window.onclick = e=>{if(e.target==modal) modal.style.display="none";}
window.addEventListener("keydown", e=>{if(e.key==="Escape") modal.style.display="none";});

function abrirModalDetalle(jugador, partida){
    let detalle = document.getElementById('detalle-jugador');
    detalle.innerHTML = `<h3>${jugador.nombre} - ${partida.id}</h3>
    <p>Cartas asignadas: ${partida.cartas.join(", ")}</p>
    <p>Estado: ${partida.estado}</p>
    <button onclick="marcarPagado('${jugador.nombre}','${partida.id}')">‚úÖ MARCAR PAGADO</button>`;
    modal.style.display = "block";
}

// WhatsApp registro
function abrirWhatsAppRegistro(nombre, partidas){
    let mensaje = `¬°Bienvenido a GANA YA! üéâ\nTus partidas han sido registradas:\n\n`;
    partidas.forEach(p=>{
        mensaje += `${p.id}\nCartas asignadas: ${p.cartas.join(", ")}\n\n`;
    });
    mensaje += "¬°Mucha suerte! üé¥";
    let tel = prompt("N√∫mero de WhatsApp del jugador (solo n√∫meros, sin +):");
    if(tel) window.open(`https://wa.me/52${tel}?text=${encodeURIComponent(mensaje)}`,'_blank');
}

// Marcar pagado
function marcarPagado(nombre,id){
    jugadores.forEach(j=>{
        if(j.nombre===nombre){
            j.partidas.forEach(p=>{
                if(p.id===id){
                    p.estado="PAGADO";
                    abrirWhatsAppPago(nombre,p);
                }
            });
        }
    });
    renderCartas();
    modal.style.display=false;
}

// WhatsApp pago
function abrirWhatsAppPago(nombre,partida){
    let mensaje = `Hola ${nombre},\nse ha realizado tu pago de $${partida.monto || 0}\na la cuenta [CLABE] el ${new Date().toLocaleDateString()}.\n\nTu carta de la suerte en esta partida fue:\nüåü ${partida.cartas[partida.cartas.length-1]} üåü\n\n¬°Felicidades por tu premio en GANA YA! üéâüá≤üáΩ`;
    let tel = prompt("N√∫mero de WhatsApp del jugador (solo n√∫meros, sin +) para pago:");
    if(tel) window.open(`https://wa.me/52${tel}?text=${encodeURIComponent(mensaje)}`,'_blank');
}

// Tomar captura
document.getElementById('tomar-captura').onclick = ()=>{
    let detalle = document.getElementById('detalle-jugador');
    html2canvas(detalle).then(canvas=>{
        let a = document.createElement('a');
        a.href = canvas.toDataURL("image/png");
        a.download = `detalle_${detalle.querySelector('h3').textContent}.png`;
        a.click();
        alert("‚úÖ Captura guardada como imagen");
    });
}

// Cambiar modo
document.getElementById('modo4').onclick=()=>{
    modo=4;
    document.getElementById('modo4').classList.add('active');
    document.getElementById('modo6').classList.remove('active');
}
document.getElementById('modo6').onclick=()=>{
    modo=6;
    document.getElementById('modo6').classList.add('active');
    document.getElementById('modo4').classList.remove('active');
}

// --- Librer√≠a html2canvas para capturas ---
let script = document.createElement('script');
script.src = "https://html2canvas.hertzen.com/dist/html2canvas.min.js";
document.body.appendChild(script);
</script>

</body>
</html>
